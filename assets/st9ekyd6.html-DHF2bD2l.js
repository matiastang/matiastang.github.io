import{_ as p,c as d,a as l,b as i,d as a,e,f as t,r as k,o as r}from"./app-CS9K37Kg.js";const c="/cloud/aliyun-ssl.png",h="/cloud/tencent-ssl.png",o="/cloud/%E8%85%BE%E8%AE%AF%E4%BA%91%E6%8F%90%E4%BA%A4%E8%AF%81%E4%B9%A6%E7%94%B3%E8%AF%B7.png",A="/cloud/%E8%85%BE%E8%AE%AF%E4%BA%91%E9%AA%8C%E8%AF%81%E5%9F%9F%E5%90%8D.png",g="/cloud/%E8%85%BE%E8%AE%AF%E4%BA%91%E8%AF%81%E4%B9%A6%E5%88%97%E8%A1%A8.png",y="/cloud/%E8%85%BE%E8%AE%AF%E4%BA%91%E4%B8%8B%E8%BD%BD%E8%AF%81%E4%B9%A6.png",u={};function v(C,s){const n=k("RouteLink");return r(),d("div",null,[s[9]||(s[9]=l('<h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h2><p>如果想使用<code>https</code>访问我们的域名。需要为域名申请证书，配置了之后就可以使用<code>https</code>访问我们的网站。</p><p>从<code>2024</code>年<code>4</code>月<code>25</code>日起，各个云平台新签发的免费证书有效期调整为 <code>90</code> 天，已经签发的不受影响。目前我的域名证书到期了，需要重新申请证书。</p><p>之前游走于各个服务商直接，证书都是一年的，觉得更新频率还行。现在想想，之后每三个月都需要去申请一次就觉得麻烦。</p><h2 id="服务商" tabindex="-1"><a class="header-anchor" href="#服务商"><span>服务商</span></a></h2><h3 id="阿里云" tabindex="-1"><a class="header-anchor" href="#阿里云"><span>阿里云</span></a></h3><h4 id="证书有效期" tabindex="-1"><a class="header-anchor" href="#证书有效期"><span>证书有效期</span></a></h4><p>阿里云免费的证书有效期为 <code>90</code> 天。</p><p><img src="'+c+'" alt="阿里云SSL证书期限"></p><p><a href="https://help.aliyun.com/zh/ssl-certificate/user-guide/purchase-an-individual-test-certificate" target="_blank" rel="noopener noreferrer">购买个人测试证书（额度）</a></p><h3 id="腾讯云" tabindex="-1"><a class="header-anchor" href="#腾讯云"><span>腾讯云</span></a></h3><h4 id="证书有效期-1" tabindex="-1"><a class="header-anchor" href="#证书有效期-1"><span>证书有效期</span></a></h4><p>腾讯云免费的证书有效期为 <code>90</code> 天。</p><p><img src="'+h+'" alt="腾讯云SSL证书期限"></p><p><a href="https://console.cloud.tencent.com/ssl" target="_blank" rel="noopener noreferrer">腾讯云 SSL证书</a></p><h4 id="申请免费证书" tabindex="-1"><a class="header-anchor" href="#申请免费证书"><span>申请免费证书</span></a></h4><p>在腾讯云的<code>SSL</code>控制台，选择<code>我的证书</code>，然后选择<code>申请免费证书</code>，目前显示免费证书最多申请50个。点击之后就会有弹窗提示：</p><p><img src="'+h+'" alt="腾讯云SSL证书期限"></p><p>我们选择<code>免费证书</code>，就进入证书申请页面了。</p><p><img src="'+o+'" alt="腾讯云提交证书申请"></p><p>这里写上需要申请证书的域名，然后选择<code>域名验证</code>方式，这里因为我是在<code>腾讯云</code>申请的域名，所以我这里选择自动验证。然后点击<code>下一步</code>。</p><p><img src="'+A+'" alt="腾讯云验证域名"></p><p>添加完成后，我们就能在证书列表里面看到，刚刚申请的证书了，处于<code>验证中</code>。一般几分钟之后就能验证完成。</p><p><img src="'+g+'" alt="腾讯云证书列表"></p><p><strong>注意</strong> 这里域名申请证书的时候，如果是根域名，则会赠送<code>www.***</code>的解析。比如我这里申请了<code>tdytech.cn</code>，证书绑定的是<code>tdytech.cn</code>和<code>www.tdytech.cn</code>两个域名。另外一个<code>api.tdytech.cn</code>就只绑定了申请的域名。</p><p><strong>注意</strong> 一般我们域名在哪个服务商那儿买的，申明证书就去对应的服务商哪儿，这样方便很多。如果不是同一个服务商，需要去域名管理里面，去添加对应的记录才行，比较麻烦。</p><h4 id="下载证书" tabindex="-1"><a class="header-anchor" href="#下载证书"><span>下载证书</span></a></h4><p>证书签发之后我们就可以在证书列表点击<code>下载</code>按钮来下载证书。</p><p><img src="'+y+`" alt="腾讯云下载证书"></p><p>服务器上我是用的<code>Nginx</code>，所以这里我么点击<code>Nginx</code>对应的证书下载。</p><p>下载证书之后，我们得到 <code>.csr</code>、<code>.key</code>、<code>.crt</code> 和 <code>.pem</code> 4个文件：</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/Downloads/tdytech.cn_nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ll</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">total</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 32</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-rw-rw-@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   1.1K</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:42</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn.csr</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-rw-rw-@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   1.7K</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:42</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn.key</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-rw-rw-@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   3.8K</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:42</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn_bundle.crt</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-rw-rw-@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   3.8K</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:42</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn_bundle.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>.csr (Certificate Signing Request)</code>这是 <strong>证书签名请求</strong> 文件，包含服务器的公钥和相关信息（如域名、组织名称等）。<code>CSR</code> 文件由你生成并发送给证书颁发机构 (<code>CA</code>)，用于申请数字证书。一旦证书签发成功，<code>CSR</code> 文件就不再需要。</li><li><code>.key (Private Key)</code>这是 <strong>私钥文件</strong>，用于加密数据和解密客户端传来的加密内容。它与生成 <code>CSR</code> 的公钥配对，必须保密。私钥是服务器 <code>HTTPS</code> 通信的核心。应该严格保密。如果私钥泄露，需要立即废弃相关证书并重新生成。</li><li><code>.crt (Certificate)</code>这是从证书颁发机构 (<code>CA</code>) 获取的 <strong>服务器证书文件</strong>，它是由 <code>CA</code> 根据你的 <code>CSR</code> 文件生成的，并包含你的域名和相关验证信息。通常配置到 <code>Nginx</code> 的 <code>ssl_certificate</code> 指令中。</li><li><code>.pem (Certificate Bundle)</code>这是一个 <strong>证书链文件</strong>，包含你的服务器证书（<code>***.crt</code>）和中间证书的集合，用于建立完整的信任链。通常配置到 <code>Nginx</code> 的 <code>ssl_certificate</code> 或相关指令中，具体取决于你的配置。</li></ul><h3 id="百度云" tabindex="-1"><a class="header-anchor" href="#百度云"><span>百度云</span></a></h3><h3 id="华为云" tabindex="-1"><a class="header-anchor" href="#华为云"><span>华为云</span></a></h3><h2 id="配置nginx" tabindex="-1"><a class="header-anchor" href="#配置nginx"><span>配置<code>Nginx</code></span></a></h2><h3 id="上传文件" tabindex="-1"><a class="header-anchor" href="#上传文件"><span>上传文件</span></a></h3><p>下载完证书后，我们将<code>tdytech.cn_bundle.pem</code>和<code>/usr/cert/tdytech.cn.key</code>这两个文件，传到<code>Nginx</code>服务器的<code>/usr/cert/</code>上。</p><p>先在服务上查看一下，存储证书的目录是否存在，如果不存在，就创建一下。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/cert</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ll</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">total</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 20</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">drwxr-xr-x</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4096</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  9</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">drwxr-xr-x</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 15</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4096</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  3</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-r--r--</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4097</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  9</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn_bundle.pem</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-r--r--</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1702</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  9</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到之前证书这两个文件，现在已经过期了，我们需要更新它们。</p><p><strong>提示</strong> 存储的位置随意，只要能和<code>Nginx</code>配置中的对应上就行。</p><p>我们使用<code>scp</code>命令来传递文件到服务器。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># cd 到下载证书的路径</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./tdytech.cn.key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdy-baidu:/usr/cert/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tdytech.cn.key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                                                 100%</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1700</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    37.8KB/s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   00:00</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./tdytech.cn_bundle.pem</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdy-baidu:/usr/cert/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tdytech.cn_bundle.pem</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                                          100%</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3885</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    89.0KB/s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   00:00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>确认一下，我们的文件是否更新了。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ll</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">drwxr-xr-x</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4096</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  9</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">drwxr-xr-x</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 15</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4096</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nov</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  3</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  2023</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ../</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-r--r--</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3885</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Jan</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:08</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn_bundle.pem</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-r--r--</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1700</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Jan</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:07</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdytech.cn.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过时间，我们确定文件是更新了的。</p>`,47)),i("p",null,[s[2]||(s[2]=i("strong",null,"提示",-1)),s[3]||(s[3]=a(" 通过")),s[4]||(s[4]=i("code",null,"SSH",-1)),s[5]||(s[5]=a("免密登录可以参考")),e(n,{to:"/linux/frx4rgfm.html"},{default:t(()=>s[0]||(s[0]=[a("ssh 命令")])),_:1}),s[6]||(s[6]=a("和")),e(n,{to:"/article/h609uylx.html"},{default:t(()=>s[1]||(s[1]=[a("Windows通过密钥访问github")])),_:1})]),s[10]||(s[10]=l(`<h3 id="修改配置文件" tabindex="-1"><a class="header-anchor" href="#修改配置文件"><span>修改配置文件</span></a></h3><p>在<code>Nginx</code>配置文件中，我们只需要配置<code>ssl_certificate</code>和<code>ssl_certificate_key</code>两个参数即可。我们这里配置<code>tdytech.cn</code>和<code>www.tdytech.cn</code>两个域名。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/nginx/conf.d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过<code>vim</code>修改配置文件。</p><div class="language-nginx line-numbers-mode" data-ext="nginx" data-title="nginx"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #SSL 默认访问端口号为 443</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    listen </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">443</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #绑定证书的域名</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    server_name </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">tdytech.cn www.tdytech.cn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #证书文件的相对路径或绝对路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_certificate </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/usr/cert/tdytech.cn_bundle.pem</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #私钥文件的相对路径或绝对路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_certificate_key </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/usr/cert/tdytech.cn.key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    ...</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置了证书之后，可以设置<code>HTTP</code>自动跳转到<code>HTTPS</code>，这样用户访问的时候，就会自动跳转到<code>HTTPS</code>上了。 在<code>Nginx</code>的配置文件下，新添如下配置：</p><div class="language-nginx line-numbers-mode" data-ext="nginx" data-title="nginx"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#HTTP 自动跳转 HTTPS 的安全配置</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     listen </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">80</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请填写绑定证书的域名</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     server_name </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">tdytech.cn www.tdytech.cn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #把http的域名请求转成https</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 301</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> https://</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">request_uri</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启<code>Nginx</code>服务，证书就配置好了。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> the</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> configuration</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> file</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/nginx/nginx.conf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> syntax</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> is</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ok</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> configuration</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> file</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/nginx/nginx.conf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> is</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> successful</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启之后，就能使用<code>https://www.tdytech.cn</code>或<code>https://tdytech.cn</code>访问我们的博客了。浏览器的警告也消失了。<code>http</code>访问也重定向到<code>https</code>了。</p><p><strong>提示</strong> 修改了<code>Nginx</code>配置后，最好先使用<code>nginx -t</code>命令检查一下配置文件是否正确，然后再重启<code>Nginx</code>服务。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>看现在各个云服务都把免费证书的有效期调整为 <code>90</code> 天了。感觉主要还是为了推他们的其他相关服务，让你们去购买他们的付费证书、自动续费等。</p><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2>`,14)),i("p",null,[e(n,{to:"/linux/frx4rgfm.html"},{default:t(()=>s[7]||(s[7]=[a("ssh 命令")])),_:1})]),i("p",null,[e(n,{to:"/article/h609uylx.html"},{default:t(()=>s[8]||(s[8]=[a("Windows通过密钥访问github")])),_:1})]),s[11]||(s[11]=i("p",null,[i("a",{href:"https://help.aliyun.com/zh/ssl-certificate/user-guide/purchase-an-individual-test-certificate",target:"_blank",rel:"noopener noreferrer"},"购买个人测试证书（额度）")],-1)),s[12]||(s[12]=i("p",null,[i("a",{href:"https://console.cloud.tencent.com/ssl",target:"_blank",rel:"noopener noreferrer"},"腾讯云 SSL证书")],-1))])}const D=p(u,[["render",v],["__file","st9ekyd6.html.vue"]]),B=JSON.parse('{"path":"/article/st9ekyd6.html","title":"域名申请证书","lang":"zh-CN","frontmatter":{"title":"域名申请证书","createTime":"2025/01/16 15:36:40","permalink":"/article/st9ekyd6.html","tags":["域名","SSL"],"watermark":true},"headers":[],"readingTime":{"minutes":6.2,"words":1860},"git":{"updatedTime":1755670488000,"contributors":[{"name":"唐道勇","username":"唐道勇","email":"matias@tangdaoyongdeMacBook-Pro.local","commits":1,"avatar":"https://avatars.githubusercontent.com/唐道勇?v=4","url":"https://github.com/唐道勇"}]},"filePathRelative":"cloud/域名申请证书.md","categoryList":[{"id":"a1234b","sort":10044,"name":"cloud"}],"bulletin":false}');export{D as comp,B as data};
