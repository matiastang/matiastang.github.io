import{_ as s,c as i,a as t,o as a}from"./app-CS9K37Kg.js";const r={};function o(n,e){return a(),i("div",null,e[0]||(e[0]=[t(`<p>安装或更新了 Docker Desktop 后启动不了 k8s，一直卡在启动状态，怎么解决？</p><p>参考<a href="https://github.com/AliyunContainerService/k8s-for-docker-desktop/tree/master" target="_blank" rel="noopener noreferrer">k8s-for-docker-desktop</a>按照里面的描述操作：</p><ul><li><code>git clone</code>项目</li><li>切换到对应的版本，如：<code>git checkout v1.29.1</code></li><li>我是先删除了一些<code>k8s</code>相关的镜像，有几个没删除掉</li><li>执行<code>sudo ./load_images.sh</code>，镜像下载完成后，重启。</li><li>如果还是不行，于是就接着往下看</li></ul><p>以前就是使用的阿里的源，所以没有调整。</p><p><strong>问题诊断</strong>：</p><p>如果看到 Kubernetes一直在启动状态，请参考</p><ul><li><a href="https://github.com/docker/for-win/issues/3769#issuecomment-486046718" target="_blank" rel="noopener noreferrer">Issue 3769(comment)</a> 或 <a href="https://github.com/docker/for-mac/issues/3649#issuecomment-497441158" target="_blank" rel="noopener noreferrer">Issue 3649(comment)</a></li></ul><ul><li>在macOS上面，执行 <code>rm -fr &#39;~/Library/Group\\ Containers/group.com.docker/pki&#39;</code></li><li>在Windows上面删除 <code>C:\\ProgramData\\DockerDesktop\\pki</code> 目录 和 <code>C:\\Users\\yourUserName\\AppData\\Local\\Docker\\pki</code> 目录</li></ul><ul><li><a href="https://github.com/docker/for-win/issues/1962#issuecomment-431091114" target="_blank" rel="noopener noreferrer">Issue 1962(comment)</a></li></ul><p>删除文件</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -fr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/Library/Group</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\ </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Containers/group.com.docker/pki</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这个时候还是不行，于是我点击了一下<code>Reset Kubernetes Cluster</code>, 然后就启动成功了。去镜像看了一下，增加了几个镜像。</p><p>期间我使用如下命令，查看了实时日志。</p><p>在Mac上，如果在Kubernetes部署的过程中出现问题，可以通过docker desktop应用日志获得实时日志信息：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pred</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">process matches &quot;.*(ocker|vpnkit).*&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  || (process in {&quot;taskgated-helper&quot;, &quot;launchservicesd&quot;, &quot;kernel&quot;} &amp;&amp; eventMessage contains[c] &quot;docker&quot;)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/usr/bin/log</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stream</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --style</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> syslog</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --level=debug</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --color=always</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --predicate</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$pred</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2><p><a href="https://github.com/AliyunContainerService/k8s-for-docker-desktop/tree/master" target="_blank" rel="noopener noreferrer">k8s-for-docker-desktop</a></p><p><a href="https://github.com/docker/for-win/issues/3769#issuecomment-486046718" target="_blank" rel="noopener noreferrer">Issue 3769(comment)</a></p><p><a href="https://github.com/docker/for-mac/issues/3649#issuecomment-497441158" target="_blank" rel="noopener noreferrer">Issue 3649(comment)</a></p><p><a href="https://github.com/docker/for-win/issues/1962#issuecomment-431091114" target="_blank" rel="noopener noreferrer">Issue 1962(comment)</a></p>`,20)]))}const p=s(r,[["render",o],["__file","jogsfmeg.html.vue"]]),c=JSON.parse('{"path":"/docker/jogsfmeg.html","title":"DockerDesktopK8s启动不了","lang":"zh-CN","frontmatter":{"title":"DockerDesktopK8s启动不了","createTime":"2025/01/21 15:39:39","permalink":"/docker/jogsfmeg.html","watermark":true},"headers":[],"readingTime":{"minutes":1.37,"words":411},"git":{"updatedTime":1755670488000,"contributors":[{"name":"唐道勇","username":"唐道勇","email":"matias@tangdaoyongdeMacBook-Pro.local","commits":1,"avatar":"https://avatars.githubusercontent.com/唐道勇?v=4","url":"https://github.com/唐道勇"}]},"filePathRelative":"notes/docker/DockerDesktopK8s启动不了.md","categoryList":[{"id":"4358b5","sort":10000,"name":"notes"},{"id":"154f33","sort":10010,"name":"docker"}],"bulletin":false}');export{p as comp,c as data};
