import{_ as i,c as a,a as n,o as l}from"./app-CS9K37Kg.js";const e={};function h(p,s){return l(),a("div",null,s[0]||(s[0]=[n(`<p>实现内网穿透的工具有很多，比如<code>ngrok</code>，<code>frp</code>等，这里介绍一下使用<code>frp</code>实现内网穿透。</p><p><strong>注意</strong> 文档要看英文文档，英文文档才比较全</p><h2 id="下载" tabindex="-1"><a class="header-anchor" href="#下载"><span>下载</span></a></h2><p>在<a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener noreferrer">frp releases</a>页面下载适合您的操作系统和体系结构的最新程序。</p><p>将<code>frps</code>二进制文件和服务器配置文件放置在具有公共 <code>IP</code> 地址的服务器 <code>A</code> 上。 将<code>frpc</code>二进制文件和客户端配置文件放在服务器 <code>B</code> 上，该服务器位于无法从公共互联网直接访问的 <code>LAN</code> 上。</p><p>一些防病毒软件错误地将 <code>frpc</code> 标记为恶意软件并将其删除。这是因为 <code>frp</code> 是一种能够创建反向代理的网络工具。防病毒软件有时会标记反向代理，因为它们能够绕过防火墙端口限制。如果您使用防病毒软件，则可能需要在防病毒设置中将 <code>frpc</code> 列入白名单/排除，以避免意外隔离/删除。有关更多详细信息，请参阅<a href="https://github.com/fatedier/frp/issues/3637" target="_blank" rel="noopener noreferrer">frp issues 3637</a>。</p><p>通过<code>arch</code>命令查看系统架构</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> arch</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">x86_64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>选择对应的发行版<code>frp_0.53.0_linux_amd64.tar.gz</code>下载。</p><p>下载后使用<code>scp</code>上传，其他上传方案也是可以的。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frps.toml</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdy-aliyun:/root/matiastang/frp/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">frps.toml</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                                                                                            100%</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">   16</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     0.4KB/s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   00:00</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> scp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tdy-aliyun:/root/matiastang/frp/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">frps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="frps安装" tabindex="-1"><a class="header-anchor" href="#frps安装"><span><code>frps</code>安装</span></a></h2><p>在具有公网 <code>IP</code> 的机器上部署 <code>frps</code> 服务端。</p><h3 id="安装systemd" tabindex="-1"><a class="header-anchor" href="#安装systemd"><span>安装<code>systemd</code></span></a></h3><p>在 <code>Linux</code> 系统下，使用 <code>systemd</code> 可以方便地控制 <code>frps</code> 服务端的启动、停止、配置后台运行以及开机自启动。 <code>MacOS</code>可以使用<code>brew services</code>。比如<code>frpc</code>部署在<code>MacOS</code>上时，可以用其进行管理。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Reading</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> package</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lists...</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Done</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Building</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dependency</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tree...</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Done</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Reading</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> state</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> information...</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Done</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">The</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> following</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packages</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> were</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> automatically</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> installed</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> and</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> are</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> longer</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> required:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  libjs-highlight.js</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libmariadb3</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mariadb-common</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Use</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apt autoremove</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> remove</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> them.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">The</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> following</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> additional</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packages</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> will</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> installed:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  libnss-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libpam-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libsystemd0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-sysv</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Suggested</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packages:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  systemd-container</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libtss2-rc0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">The</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> following</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packages</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> will</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> upgraded:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  libnss-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libpam-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libsystemd0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-sysv</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">5</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> upgraded,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> newly</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> installed,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> remove</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> and</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 78</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> not</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> upgraded.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Need</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 5,245</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kB</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> of</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> archives.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> this</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> operation,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 4,096</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> B</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> disk</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> space</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> will</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> freed.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Do</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> you</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> want</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> continue?</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [Y/n] y</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Get:1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirrors.cloud.aliyuncs.com/ubuntu</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jammy-updates/main</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-sysv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 249.11-0ubuntu3.11</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [10.5 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kB]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Get:2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirrors.cloud.aliyuncs.com/ubuntu</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jammy-updates/main</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libnss-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 249.11-0ubuntu3.11</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [133 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kB]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Get:3</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirrors.cloud.aliyuncs.com/ubuntu</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jammy-updates/main</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libpam-systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 249.11-0ubuntu3.11</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [203 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kB]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Get:4</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirrors.cloud.aliyuncs.com/ubuntu</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jammy-updates/main</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 249.11-0ubuntu3.11</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [4,581 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kB]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Get:5</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirrors.cloud.aliyuncs.com/ubuntu</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jammy-updates/main</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libsystemd0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> amd64</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 249.11-0ubuntu3.11</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [318 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kB]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Fetched</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 5,245</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kB</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 0s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (14.1 </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">MB/s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Reading</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> database</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 104078</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> files</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> and</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> directories</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> currently</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> installed.</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Preparing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unpack</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .../systemd-sysv_249.11-0ubuntu3.11_amd64.deb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unpacking</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-sysv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) over (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">249.11-0ubuntu3.9</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Preparing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unpack</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .../libnss-systemd_249.11-0ubuntu3.11_amd64.deb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unpacking</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libnss-systemd:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) over (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">249.11-0ubuntu3.9</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Preparing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unpack</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .../libpam-systemd_249.11-0ubuntu3.11_amd64.deb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unpacking</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libpam-systemd:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) over (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">249.11-0ubuntu3.9</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Preparing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unpack</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .../systemd_249.11-0ubuntu3.11_amd64.deb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unpacking</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) over (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">249.11-0ubuntu3.9</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Preparing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unpack</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .../libsystemd0_249.11-0ubuntu3.11_amd64.deb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Unpacking</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libsystemd0:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) over (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">249.11-0ubuntu3.9</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Setting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libsystemd0:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Setting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Setting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-sysv</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Setting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libnss-systemd:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Setting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libpam-systemd:amd64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (249.11-0ubuntu3.11) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Processing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> triggers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> for</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> man-db</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (2.10.2-1) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Processing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> triggers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> for</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dbus</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (1.12.20-2ubuntu4.1) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Processing</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> triggers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> for</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> libc-bin</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (2.35-0ubuntu3.5) ...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Scanning</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> processes...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Scanning</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> candidates...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Scanning</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> linux</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> images...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Running</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kernel</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> seems</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up-to-date.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Restarting</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> services...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> /etc/needrestart/restart.d/systemd-manager</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> multipathd.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packagekit.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> polkit.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> redis-server.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsyslog.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ssh.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tuned.service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> udisks2.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Service</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restarts</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> being</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deferred:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ModemManager.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> /etc/needrestart/restart.d/dbus.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> getty@tty1.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> networkd-dispatcher.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-logind.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unattended-upgrades.service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> user@0.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">No</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> containers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> need</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restarted.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">No</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sessions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> are</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> running</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> outdated</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> binaries.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">No</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> VM</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> guests</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> are</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> running</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> outdated</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hypervisor</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (qemu) binaries on this host.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建-frps-service-文件" tabindex="-1"><a class="header-anchor" href="#创建-frps-service-文件"><span>创建 <code>frps.service</code> 文件</span></a></h3><p>使用文本编辑器 (如 <code>vim</code>) 在 <code>/etc/systemd/system</code> 目录下创建一个 <code>frps.service</code> 文件，用于配置 <code>frps</code> 服务。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/systemd/system/frps.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>写入如下内容</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Unit</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务名称，可自定义</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Description</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> server</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">After</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> network.target</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> syslog.target</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Wants</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Service</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> simple</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动frps的命令，需修改为您的frps的安装路径</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ExecStart = /path/to/frps -c /path/to/frps.toml</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 将/path/to替换为您的frps安装路径，在frps的安装目录下使用pwd查看路径。如上面我上传到的地址是\`/root/matiastang/frp\`所以如下配置</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ExecStart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/matiastang/frp/frps</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/matiastang/frp/frps.toml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Install</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">WantedBy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>systemd</code> 命令管理 <code>frps</code> 服务</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动frp</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 停止frp</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 重启frp</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看frp状态</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> status</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">设置</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 开机自启动</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> enable</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>提示</strong> 可以通过服务端的<code>nginx</code>代理用于内网穿透的端口。应该就不用开放其他特殊的端口了。 示例：</p><div class="language-nginx line-numbers-mode" data-ext="nginx" data-title="nginx"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #SSL 默认访问端口号为 443</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     listen </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">443</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请填写绑定证书的域名</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     server_name </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api.dytech.cn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请填写证书文件的相对路径或绝对路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_certificate </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/usr/cert/api.tdytech.cn_bundle.pem</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请填写私钥文件的相对路径或绝对路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_certificate_key </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/usr/cert/api.tdytech.cn.key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #缓存SSL握手产生的参数和加密密钥的时长</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_session_timeout </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">5m</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请按照以下协议配置</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_protocols </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">TLSv1.2 TLSv1.3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_ciphers </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #加密套件优先选择服务器的加密套件</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     ssl_prefer_server_ciphers on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">     location</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     	proxy_pass </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">http://localhost:8080</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        proxy_set_header </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Host </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        proxy_set_header </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">X-Real-IP </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">remote_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        proxy_set_header </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">X-Forwarded-For </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">proxy_add_x_forwarded_for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">     }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#HTTP 自动跳转 HTTPS 的安全配置</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     listen </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">80</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #请填写绑定证书的域名</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     server_name </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api.tdytech.cn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     #把http的域名请求转成https</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     return</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 301</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> https://</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">request_uri</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>直接将<code>80</code>和<code>443</code>的代理到本机的<code>8080</code>端口，穿透到内网。</p><p><strong>注意</strong> 这里代理的是<code>/</code>，如果是某个前缀<code>/web/</code>的<code>web</code>服务，打包的资源就需要注意，也需要添加前缀。如果是后端服务就不需要这么处理。</p><h2 id="frpc安装" tabindex="-1"><a class="header-anchor" href="#frpc安装"><span>frpc安装</span></a></h2><h3 id="macos安装frpc" tabindex="-1"><a class="header-anchor" href="#macos安装frpc"><span>MacOS安装frpc</span></a></h3><p>下载<code>frp_0.53.0_darwin_amd64.tar.gz</code>，并修改<code>frpc.toml</code>文件。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 修改为服务器的公网地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">serverAddr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">serverPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">proxies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">web</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">localPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3000</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remotePort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 修改为公网域名</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">customDomains</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">www.example.cn</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>frpc</code>操作脚本</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">###</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @Author: matiastang</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @Date: 2023-12-21 16:43:16</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @LastEditors: matiastang</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @LastEditTime: 2023-12-21 16:50:35</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @FilePath: /HulkPress/Users/matias/matias/MT/MTGithub/tool/frpc/frpc.sh</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # @Description: MacOS 脚本启动停止frpc服务</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">### </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">FRPC_HOME</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$HOME/matias/MT/MTGithub/tool/frpc</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">client</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$FRPC_HOME/frpc</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">toml</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$FRPC_HOME/frpc.toml</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$FRPC_HOME/log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">start</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">then</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  nohup</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $client</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/nohup_frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frpc start success</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">elif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">status</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">then</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   ps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> aux</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> grep</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">   echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frpc status success</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">elif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">reload</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">then</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frpc</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> \`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$client reload -c $toml</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">elif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">restart</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">then</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  ps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> aux</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> grep</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $1</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> awk</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">{print $2}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> xargs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kill</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -9</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/nohup_frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  nohup</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $client</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/nohup_frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frpc restart success</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">elif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">stop</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">then</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  ps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> aux</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> grep</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $1</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> awk</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">{print $2}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> xargs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kill</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -9</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$log/nohup_frpc.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frpc stop success</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">else</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  other_commands</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$client $@</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  $other_commands</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切换到<code>frpc.sh</code>所在目录，运行测试一下</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">zsh:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> permission</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> denied:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>修改文件的权限</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chmod</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 755</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ll</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">total</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 29568</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rwxr-xr-x@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    14M</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 12</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 14</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 21:00</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rwxr-xr-x</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">  1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   1.2K</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 12</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:50</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-rw-r--r--@</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> matias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  staff</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   235B</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 12</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:27</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.toml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再次运行</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>弹窗提示：<code>无法打开“frpc”，因为无法验证开发者。</code></p><p><strong>重要</strong> 这是被系统拦截了，在系统的<code>安全与隐私</code>的<code>通用</code>中，允许运行。</p><p>再次运行</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> success</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>直接运行</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./nohup_frpc.log</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 28462</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  ⚙</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/matias/MT/MTGithub/tool/frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> </span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  + 28462 exit 1     nohup ./frpc -c frpc.toml </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ./nohup_frpc.log </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">2&gt;&amp;1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup_frpc.log</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:03:23</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root.go:141</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> start frpc service </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> config file </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">frpc.toml</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:03:23</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">service.go:288</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> try to connect to server...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:03:33</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [W] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">service.go:291</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> connect to server error: dial tcp 8.134.116.20:7000: i/o timeout</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 17:03:33</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root.go:159</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frpc service </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> config file </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">frpc.toml</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> stopped</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">login</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> the</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> server</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> failed:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dial</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tcp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 8.134.116.20:7000:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> i/o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> timeout.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> With</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> loginFailExit</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> enabled,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> additional</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> retries</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> will</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> be</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> attempted</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>链接超时了，所以要先启动<code>frps</code>且在安全组里开放<code>7000</code>和<code>8080</code>端口后再试。</p><p>切到服务器启动<code>frps</code></p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安全组开放<code>7000</code>和<code>8080</code>端口后再试</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./nohup_frpc.log</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 29059</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./nohup_frpc.log</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 30034</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>kill</code>掉<code>frpc</code></p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kill</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -9</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 29059</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  + 29059 killed     nohup ./frpc -c frpc.toml </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ./nohup_frpc.log </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">2&gt;&amp;1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>访问<code>http://*.*.*.*:8080/</code></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>The page you requested was not found.</span></span>
<span class="line"><span>Sorry, the page you are looking for is currently unavailable.</span></span>
<span class="line"><span>Please try again later.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>The server is powered by frp.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Faithfully yours, frp.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>更新<code>customDomains</code>为绑定的域名，这里必须要一样，开始写错了，没访问成功。</p><p>再次运行</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frpc</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc.toml</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./nohup_frpc.log</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> 2&gt;&amp;1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 34950</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>再次访问<code>http://*.*.*.*:8080/</code>，成功了。</p><p>添加软链到系统环境变量</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $HOME</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/matias/MT/MTGithub/tool/frpc/frpc.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/frpc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /Users/matias/matias/MT/MTGithub/tool/frpc/frpc.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/frpc</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/usr/local/bin/frpc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动frpc服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看frpc启动状态</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> status</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 重启frpc服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 停止frpc服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frpc</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stop</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="添加认证方式-需要在frps-toml和frpc-toml中都配置-且配置一样的token" tabindex="-1"><a class="header-anchor" href="#添加认证方式-需要在frps-toml和frpc-toml中都配置-且配置一样的token"><span>添加认证方式，需要在<code>frps.toml</code>和<code>frpc.toml</code>中都配置，且配置一样的<code>token</code></span></a></h3><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">auth.method</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">token</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">auth.token</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">password</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置frp服务端仪表盘" tabindex="-1"><a class="header-anchor" href="#配置frp服务端仪表盘"><span>配置frp服务端仪表盘</span></a></h3><p><code>frps.toml</code>添加如下配置。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps.toml</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务端监听端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bindPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># http代理监听端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vhostHTTPPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务端仪表盘配置</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7500</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.addr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dashboard&#39;s username and password are both optional</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 用户名</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 密码</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.password</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin001</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启frp</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 重启frp</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>访问<code>http://[serverAddr]:7500</code>即可查看仪表盘。</p><p>配置证书 在<code>frps.toml</code>文件中添加如下配置</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务端tls证书配置</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.tls.certFile = &quot;/usr/cert/[***].pem&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.tls.keyFile = &quot;/usr/cert/[***].key&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.tls.certFile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server.crt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.tls.keyFile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>https</code>访问</p><p>访问<code>https://[serverAddr]:7500</code>即可查看仪表盘。</p><h3 id="配置frp客户端仪表盘" tabindex="-1"><a class="header-anchor" href="#配置frp客户端仪表盘"><span>配置frp客户端仪表盘</span></a></h3><p>在<code>frpc.toml</code>中添加相关代码</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 客户端仪表盘</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.addr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7400</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.password</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin001</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>访问<code>http://127.0.0.1:7400</code>并没有响应。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lsof</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> :7400</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>发现端口<code>7400</code>没有被占用，表面服务没启动成功。所以访问不了。</p><p>排查了一圈发现，原理是<code>webServer</code>相关配置写的位置不对。我放在了文件的最下面。中间有一些<code>[[proxies]]</code>。这样的话就没启动服务，需要吧<code>webServer</code>提到顶部和<code>serverAddr</code>一级的位置！应该是<code>.toml</code>文件的不同位置解析出来的结果不一样，如果换成<code>.json</code>应该就不容易出错。</p><p>重新配置之后能<code>http://127.0.0.1:7400</code>正常访问了。 本地服务启动成功后，日志文件中有个<code>admin server listen on 127.0.0.1:7400</code>的提示。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nohup_frpc.log</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root.go:141</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> start frpc service </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> config file </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">frpc.toml</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">service.go:288</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> try to connect to server...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">service.go:279</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3e9cb769fb0b986e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> login to server success, get run id </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3e9cb769fb0b986e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">proxy_manager.go:173</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3e9cb769fb0b986e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> proxy added: </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">web_http web_https</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">service.go:177</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> admin server listen on 127.0.0.1:7400</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control.go:169</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3e9cb769fb0b986e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">web_https</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> start proxy success</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:03</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">control.go:169</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3e9cb769fb0b986e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">web_http</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> start proxy success</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:17</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:170</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http request </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/status</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:17</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:172</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http response </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/status</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:23</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:203</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http get request </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:23</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:205</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http get response </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, code </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">200</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:170</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http request </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/status</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:172</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http response </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/status</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:26</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:203</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http get request </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2023/12/22</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16:18:26</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [I] </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">admin_api.go:205</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Http get response </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/api/config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, code </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">200</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最终配置" tabindex="-1"><a class="header-anchor" href="#最终配置"><span>最终配置</span></a></h2><h3 id="frps-toml配置" tabindex="-1"><a class="header-anchor" href="#frps-toml配置"><span><code>frps.toml</code>配置</span></a></h3><p>开放了两个端口：<code>8080</code>用于监听<code>http</code>代理，<code>8443</code>用于监听<code>https</code>代理。 配置了<code>frps</code>监控服务。</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps.toml</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务端监听端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bindPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># http代理监听端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vhostHTTPPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># https代理监听端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vhostHTTPSPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 服务端仪表盘配置</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7500</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 地址(这里需要注意，需要绑定到所有网络上，外网访问)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.addr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dashboard&#39;s username and password are both optional</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 用户名</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 密码</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.password</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin001</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 证书配置</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.tls.certFile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/cert/***.pem</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.tls.keyFile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/cert/***.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="frpc-toml配置" tabindex="-1"><a class="header-anchor" href="#frpc-toml配置"><span><code>frpc.toml</code>配置</span></a></h3><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">serverAddr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">*.*.*.*</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">serverPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 客户端仪表盘</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.addr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7400</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.password</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin001</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">proxies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">web_http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">localPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3000</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remotePort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">customDomains</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">域名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">proxies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">web_https</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remotePort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8443</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">customDomains</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">域名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">proxies.plugin</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https2http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 本地应用端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">localAddr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1:3000</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># HTTPS 证书相关的配置，修改证书文件路径(证书要是customDomains中配置域名的证书)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">crtPath</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/Users/matias/matias/matiasResources/certificates/***.pem</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">keyPath</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/Users/matias/matias/matiasResources/certificates/***.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hostHeaderRewrite</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">requestHeaders.set.x-from-where</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">frp</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="toml参数说明" tabindex="-1"><a class="header-anchor" href="#toml参数说明"><span>.toml参数说明</span></a></h3><p><a href="https://github.com/fatedier/frp/blob/dev/conf/frps_full_example.toml" target="_blank" rel="noopener noreferrer">frps.toml</a><a href="https://github.com/fatedier/frp/blob/dev/conf/frpc_full_example.toml" target="_blank" rel="noopener noreferrer">frpc.toml</a></p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 必须包含 IPv6 的文字地址或主机名</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 在方括号中，如&quot;[::1]:80&quot;、&quot;[ipv6-host]:http&quot;或&quot;[ipv6-host%zone]:80&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 对于单个&quot;bind_addr&quot;字段，不需要方括号，如&quot;bind_addr = ::&quot;。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bindAddr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">bindPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 用于 kcp 协议的 udp 端口，可以与 &#39;bind_port&#39; 相同。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果未设置，kcp 在 frps 中被禁用。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kcpBindPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 用于 quic 协议的 udp 端口。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果没有设置，quic 在 frps 中被禁用。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># quicBindPort = 7002</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 指定代理监听哪个地址，默认值与bind_addr相同</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># proxy_bind_addr = &quot;127.0.0.1&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># quic协议选项</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.quic.keepalivePeriod = 10</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.quic.maxIdleTimeout = 30</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.quic.maxIncomingStreams = 100000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 心跳配置，不建议修改默认值</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># heartbeat_timeout 默认值为 90。设置负值即可禁用。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.heartbeatTimeout = 90</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 每个代理中的池计数将不超过 maxPoolCount。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">transport.maxPoolCount</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果使用tcp流复用，默认为true</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tcpMux = true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 指定 tcp mux 的保持活动间隔。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 仅当 tcpMux 为 true 时才有效。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tcpMuxKeepaliveInterval = 60</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># tcpKeepalive 指定 frpc 和 frps 之间活动网络连接的 keep-alive 探测之间的时间间隔。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果为负，则禁用保持活动探测。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tcpKeepalive = 7200</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Transport.tls.force 指定是否只接受 TLS 加密的连接。 默认情况下，该值为 false。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tls.force</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tls.certFile = &quot;server.crt&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tls.keyFile = &quot;server.key&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># transport.tls.trustedCaFile = &quot;ca.crt&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果要支持虚拟主机，必须设置监听的http端口（可选）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 注意：http端口和https端口可以与bind_port相同</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vhostHTTPPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 80</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vhostHTTPSPort</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># vhost http服务器的响应头超时（秒），默认为60秒</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># vhostHTTPTimeout = 60</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># tcpmuxHTTPConnectPort 指定服务器监听 TCP 的端口</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># HTTP CONNECT 请求。 如果值为0，服务器不会复用TCP</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 单个端口上的请求。 如果不是 - 它将监听这个值</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># HTTP CONNECT 请求。 默认情况下，该值为 0。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># tcpmuxHTTPConnectPort = 1337</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果 tcpmux_passthrough 为 true，frps 不会对流量进行任何更新。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># tcpmuxPassthrough = false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 配置Web服务器以启用frps的仪表板。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 仅当设置了 webServer.port 时，仪表板才可用。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.addr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7500</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">webServer.password</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">admin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.tls.certFile = &quot;server.crt&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.tls.keyFile = &quot;server.key&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># dashboard assets directory(only for debug mode)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.assetsDir = &quot;./static&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 在仪表板监听器中启用 golang pprof 处理程序。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 必须首先设置仪表板端口</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># webServer.pprofEnable = false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#enablePrometheus 将在 /metrics api 中导出 webServer 上的 prometheus 指标。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># enablePrometheus = true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 控制台或真实日志文件路径，如 ./frps.log</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log.to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./frps.log</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># trace, debug, info, warn, error</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log.level</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">info</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log.maxDays</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 当 log.to 为控制台时禁用日志颜色，默认为 false</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log.disablePrintColor</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#DetailedErrorsToClient 定义是否将特定错误（带有调试信息）发送到 frpc。 默认情况下，该值为 true。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">detailedErrorsToClient</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.method 指定使用什么身份验证方法对 frpc 和 frps 进行身份验证。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果指定了&quot;token&quot; - 令牌将被读入登录消息。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果指定&quot;oidc&quot; - 将使用 OIDC 设置颁发 OIDC（开放 ID 连接）令牌。 默认情况下，该值为&quot;token&quot;。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">auth.method</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">token</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.additionalScopes 指定包含身份验证信息的附加范围。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 可选值为 HeartBeats、NewWorkConns。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.additionalScopes = [&quot;HeartBeats&quot;, &quot;NewWorkConns&quot;]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth token</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">auth.token</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">123456</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># oidc 发行者指定验证 OIDC 令牌的发行者。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.oidc.issuer = &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># oidcaudience 指定验证时 OIDC 令牌应包含的受众。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.oidc.audience = &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># oidc SkipExpiryCheck 指定是否在 OIDC 令牌过期时跳过检查。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.oidc.skipExpiryCheck = false</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># oidc skipIssuerCheck 指定是否跳过检查 OIDC 令牌的颁发者声明是否与 OidcIssuer 中指定的颁发者匹配。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># auth.oidc.skipIssuerCheck = false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># userConnTimeout 指定等待工作连接的最长时间。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># userConnTimeout = 10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 只允许 frpc 绑定您列出的端口。 默认情况下，不会有任何限制。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># allowPorts = [</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#   { start = 2000, end = 3000 },</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#   { single = 3001 },</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#   { single = 3003 },</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#   { start = 4000, end = 50000 }</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 每个客户端可以使用的最大端口数，默认值为0表示无限制</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">maxPortsPerClient</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 如果subDomainHost不为空，则可以在frpc的配置文件中设置type为http或https时的子域名</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># subDomainHost = &quot;frps.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># subdomain为test时，路由使用的host为test.frps.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># subDomainHost = &quot;*.proxy.frps.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># subdomain为test时，路由使用的host为test.proxy.frps.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># HTTP 请求的自定义 404 页面</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># custom404Page = &quot;/path/to/404.html&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 指定udp数据包大小，单位为字节。 如果未设置，则默认值为 1500。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 这个参数在客户端和服务器之间应该是相同的。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 它影响 udp 和 sudp 代理。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">udpPacketSize</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1500</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># NAT打洞策略数据的保留时间。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">natholeAnalysisDataReserveHours</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 168</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># [[http插件]]</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># name = &quot;user-manager&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># addr = &quot;127.0.0.1:9000&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># path = &quot;/handler&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ops = [&quot;Login&quot;]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># [[http插件]]</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># name = &quot;port-manager&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># addr = &quot;127.0.0.1:9001&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># path = &quot;/handler&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ops = [&quot;NewProxy&quot;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 配置使用之前记得验证一下，是否正常</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./frps</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> verify</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> frps.toml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2><p><a href="https://gofrp.org/zh-cn/docs/" target="_blank" rel="noopener noreferrer">frp文档</a></p><p><a href="https://github.com/fatedier/frp" target="_blank" rel="noopener noreferrer">frp github</a></p><p><a href="https://gofrp.org/zh-cn/docs/examples/xtcp/" target="_blank" rel="noopener noreferrer">frp</a></p><p><a href="https://www.haoyizebo.com/posts/fd0b9bd8/" target="_blank" rel="noopener noreferrer">Docker for Mac 的网络问题及解决办法（新增方法四）</a></p>`,98)]))}const k=i(e,[["render",h],["__file","ykrvu023.html.vue"]]),d=JSON.parse('{"path":"/article/ykrvu023.html","title":"frp 内网穿透","lang":"zh-CN","frontmatter":{"title":"frp 内网穿透","createTime":"2025/01/20 16:35:36","permalink":"/article/ykrvu023.html","tags":["Linux","Windows","MacOS"],"watermark":true},"headers":[],"readingTime":{"minutes":13.32,"words":3996},"git":{"updatedTime":1755670488000,"contributors":[{"name":"唐道勇","username":"唐道勇","email":"matias@tangdaoyongdeMacBook-Pro.local","commits":1,"avatar":"https://avatars.githubusercontent.com/唐道勇?v=4","url":"https://github.com/唐道勇"}]},"filePathRelative":"linux/frp内网穿透.md","categoryList":[{"id":"e206a5","sort":10040,"name":"linux"}],"bulletin":false}');export{k as comp,d as data};
